<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Memory Match ‚Äî MiniArcade</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../css/style.css" />
  <style>
    .mem-wrap {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.5rem;
      width: 100%;
    }

    .mem-toolbar {
      display: flex;
      align-items: center;
      gap: 1.5rem;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: 0.75rem 1.5rem;
      font-family: var(--font-mono);
      flex-wrap: wrap;
      justify-content: center;
    }

    .mem-stat { text-align: center; }
    .mem-stat .ms-val  { font-size:1.3rem; font-weight:800; color:var(--text-primary); }
    .mem-stat .ms-lbl  { font-size:0.62rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:.06em; }

    #memGrid {
      display: grid;
      gap: 10px;
      padding: 0;
    }

    .mem-card {
      width: 90px;
      height: 90px;
      perspective: 600px;
      cursor: pointer;
    }

    .mem-card-inner {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.4s cubic-bezier(.4,0,.2,1);
      border-radius: 12px;
    }

    .mem-card.flipped .mem-card-inner  { transform: rotateY(180deg); }
    .mem-card.matched .mem-card-inner  { transform: rotateY(180deg); }

    .mem-card-front, .mem-card-back {
      position: absolute;
      inset: 0;
      border-radius: 12px;
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.4rem;
    }

    .mem-card-back {
      background: var(--bg-card);
      border: 1px solid var(--border);
      transition: border-color 0.2s;
      font-size: 1.4rem;
      color: var(--text-muted);
    }
    .mem-card:hover:not(.flipped):not(.matched) .mem-card-back {
      border-color: var(--accent-secondary);
      background: var(--bg-card-hover);
    }

    .mem-card-front {
      background: linear-gradient(135deg, #081a1f, #0b222a);
      border: 1px solid rgba(34,211,238,0.3);
      transform: rotateY(180deg);
    }

    .mem-card.matched .mem-card-front {
      background: linear-gradient(135deg, #052e16, #064e3b);
      border-color: rgba(16,185,129,0.5);
      box-shadow: 0 0 16px rgba(16,185,129,0.3);
      animation: match-pop 0.3s ease;
    }

    @keyframes match-pop {
      0%   { transform: rotateY(180deg) scale(1); }
      40%  { transform: rotateY(180deg) scale(1.15); }
      100% { transform: rotateY(180deg) scale(1); }
    }

    .mem-card.wrong .mem-card-inner {
      animation: wrong-shake 0.4s ease;
    }
    @keyframes wrong-shake {
      0%,100%{transform:rotateY(180deg) translateX(0);}
      25%{transform:rotateY(180deg) translateX(-5px);}
      75%{transform:rotateY(180deg) translateX(5px);}
    }

    .diff-selector { display:flex; gap:.5rem; flex-wrap:wrap; justify-content:center; }
    .diff-btn {
      font-family:var(--font-mono);font-size:.72rem;padding:4px 14px;
      border-radius:999px;border:1px solid var(--border);background:none;
      color:var(--text-secondary);cursor:pointer;transition:all .2s;
    }
    .diff-btn.active,.diff-btn:hover{border-color:#22d3ee;color:#22d3ee;background:rgba(34,211,238,.08);}

    .win-banner {
      display:none;
      flex-direction:column;
      align-items:center;
      gap:0.75rem;
      background:var(--bg-card);
      border:1px solid rgba(16,185,129,0.3);
      border-radius:var(--radius-lg);
      padding:2rem 3rem;
      text-align:center;
      box-shadow:0 0 40px rgba(16,185,129,0.15);
    }
    .win-banner.show { display:flex; }
  </style>
</head>
<body class="game-page">

<nav class="navbar">
  <a href="../index.html" class="nav-logo">
    <div class="logo-icon">üïπÔ∏è</div>
    Mini<span class="dim">Arcade</span>
  </a>
</nav>

<div class="game-header">
  <div class="game-header-left">
    <a href="../index.html" class="back-link">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
      Games
    </a>
    <div class="game-title-badge">
      <h2>üÉè Memory Match</h2>
      <span class="live-badge">LIVE</span>
    </div>
  </div>
  <div class="game-stats-bar">
    <div class="stat-box"><span class="label">Moves</span><span class="value" id="hMoves">0</span></div>
    <div class="stat-box"><span class="label">Pairs</span><span class="value" id="hPairs">0</span></div>
    <div class="stat-box"><span class="label">Time</span><span class="value" id="hTime">0s</span></div>
  </div>
</div>

<div class="game-arena" style="flex-direction:column">
  <div class="mem-wrap">
    <div class="diff-selector">
      <button class="diff-btn active" onclick="setDiff(4,this)">4√ó4 Easy</button>
      <button class="diff-btn" onclick="setDiff(6,this)">6√ó4 Med</button>
      <button class="diff-btn" onclick="setDiff(6,this,'hard')">6√ó6 Hard</button>
    </div>

    <div class="mem-toolbar">
      <div class="mem-stat">
        <div class="ms-val" id="movesVal">0</div>
        <div class="ms-lbl">Moves</div>
      </div>
      <div class="mem-stat">
        <div class="ms-val" id="pairsVal">0/0</div>
        <div class="ms-lbl">Pairs</div>
      </div>
      <div class="mem-stat">
        <div class="ms-val" id="timerVal">0s</div>
        <div class="ms-lbl">Time</div>
      </div>
      <button class="btn btn-ghost" onclick="newGame()" style="padding:6px 16px;font-size:0.82rem">‚Ü© Restart</button>
    </div>

    <div id="winBanner" class="win-banner">
      <div style="font-size:2.5rem">üéâ</div>
      <div style="font-size:1.4rem;font-weight:800;letter-spacing:-0.02em">All pairs matched!</div>
      <div style="color:var(--text-secondary);font-size:0.9rem" id="winSub"></div>
      <button class="btn btn-primary" style="margin-top:0.5rem" onclick="newGame()">Play Again</button>
    </div>

    <div id="memGrid"></div>
  </div>
</div>

<script>
const EMOJIS = [
  'ü¶ä','üêâ','üåä','‚ö°','üî•','üåô','üéØ','üíé',
  'üöÄ','üå∫','ü¶ã','üé∏','üçÄ','ü¶Å','üê¨','üåà',
  'üèÜ','‚öîÔ∏è','üéÆ','üß©','ü¶Ñ','üåü','üé™','üé≠'
];

let cols, rows, pairs, cards, flipped, matched, moves, elapsed, timerInterval, canFlip;

let gridCols = 4;
let gridRows = 4;

function setDiff(c, btn, mode) {
  gridCols = c;
  gridRows = mode === 'hard' ? 6 : 4;
  document.querySelectorAll('.diff-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  newGame();
}

function newGame() {
  cols = gridCols; rows = gridRows;
  pairs = (cols*rows)/2;
  const pool = EMOJIS.slice(0,pairs);
  cards = shuffle([...pool,...pool]);
  flipped = [];
  matched = new Set();
  moves   = 0;
  elapsed = 0;
  canFlip = true;
  clearInterval(timerInterval);
  timerInterval = setInterval(()=>{elapsed++;updateHUD();},1000);
  document.getElementById('winBanner').classList.remove('show');
  renderGrid();
  updateHUD();
}

function shuffle(arr) {
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}

function renderGrid() {
  const grid = document.getElementById('memGrid');
  grid.style.gridTemplateColumns = `repeat(${cols},90px)`;
  grid.innerHTML = '';
  cards.forEach((emoji,i) => {
    const card = document.createElement('div');
    card.className = 'mem-card';
    card.dataset.idx = i;
    card.innerHTML = `
      <div class="mem-card-inner">
        <div class="mem-card-front">${emoji}</div>
        <div class="mem-card-back">?</div>
      </div>`;
    if (matched.has(i)) card.classList.add('matched');
    if (flipped.includes(i) && !matched.has(i)) card.classList.add('flipped');
    card.addEventListener('click',()=>handleClick(i,card));
    grid.appendChild(card);
  });
}

function handleClick(i, card) {
  if (!canFlip||matched.has(i)||flipped.includes(i)) return;
  card.classList.add('flipped');
  flipped.push(i);

  if (flipped.length===2) {
    moves++;
    canFlip=false;
    updateHUD();
    const [a,b]=flipped;
    if(cards[a]===cards[b]) {
      matched.add(a); matched.add(b);
      document.querySelectorAll(`.mem-card[data-idx="${a}"]`)[0].classList.add('matched');
      document.querySelectorAll(`.mem-card[data-idx="${b}"]`)[0].classList.add('matched');
      flipped=[];
      canFlip=true;
      updateHUD();
      if(matched.size/2===pairs) winGame();
    } else {
      // Wrong ‚Äî shake and flip back
      const cards_els=document.querySelectorAll('.mem-card');
      [a,b].forEach(idx=>{
        cards_els[idx].classList.add('wrong');
      });
      setTimeout(()=>{
        [a,b].forEach(idx=>{
          const el=cards_els[idx];
          el.classList.remove('flipped','wrong');
        });
        flipped=[];
        canFlip=true;
      },900);
    }
  }
}

function winGame() {
  clearInterval(timerInterval);
  const sub=document.getElementById('winSub');
  sub.textContent=`${moves} moves ¬∑ ${elapsed} seconds`;
  document.getElementById('winBanner').classList.add('show');
}

function updateHUD(){
  document.getElementById('movesVal').textContent = moves;
  document.getElementById('pairsVal').textContent = `${matched.size/2}/${pairs}`;
  document.getElementById('timerVal').textContent  = elapsed+'s';
  document.getElementById('hMoves').textContent   = moves;
  document.getElementById('hPairs').textContent   = `${matched.size/2}/${pairs}`;
  document.getElementById('hTime').textContent    = elapsed+'s';
}

newGame();
</script>
</body>
</html>
